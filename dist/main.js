(()=>{"use strict";class e{constructor(e,t,o){this._name=e.name,this._link=e.link,this._handleCardClick=t,this._cardSelector=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".cards__conteiner").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".cards__emotion").addEventListener("click",(()=>{this._clickLike()})),this._element.querySelector(".cards__trashicon").addEventListener("click",(()=>{this._clickDelete()})),this._element.querySelector(".cards__image").addEventListener("click",(()=>{this._handleCardClick(this._link,this._name)}))}_clickLike(){this._element.querySelector(".cards__emotion").classList.toggle("cards__emotion_active")}_clickDelete(){this._element.remove(),this._element=null}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".cards__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".cards__title").textContent=this._name,this._element}}class t{constructor(e,t){this._selectorsConfiguration=e,this._formElement=t,this._submitButton=this._formElement.querySelector(this._selectorsConfiguration.submitButtonSelector),this._inputSelector=Array.from(this._formElement.querySelectorAll(this._selectorsConfiguration.inputSelector))}_showInputError(e,t){const o=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._selectorsConfiguration.errorClass),o.textContent=t,o.classList.add(this._selectorsConfiguration.inputErrorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._selectorsConfiguration.errorClass),t.textContent="",t.classList.remove(this._selectorsConfiguration.inputErrorClass)}_isValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputSelector.some((e=>!e.validity.valid))}_activetingSubmit(){this._submitButton.classList.remove(this._selectorsConfiguration.inactiveButtonClass),this._submitButton.removeAttribute("disabled")}deactivetingSubmit(){this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this._selectorsConfiguration.inactiveButtonClass)}_toggleButtonState(e){this._hasInvalidInput(e)?this.deactivetingSubmit():this._activetingSubmit()}_setEventListeners(){this._toggleButtonState(),this._inputSelector.forEach((e=>{e.addEventListener("input",(()=>{this._isValid(e),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}}class o{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_type_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_type_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this._popup.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.contains("popup_type_opened")||e.target.contains("popup__close"))&&this._popup.close()}))}}const n=document.querySelector(".profile__button"),s=document.querySelector("#popupEdit"),r=document.querySelector("#popupZoom"),i=document.querySelector("#popupAdd"),p=document.querySelector(".popup__close_add"),c=document.querySelector(".popup__close_edit"),u=document.querySelector(".popup__close_zoom"),l=document.querySelector(".popup__form"),a=document.querySelector(".profile__name"),_=document.querySelector(".profile__spec"),d=document.querySelector(".popup__input_name"),m=document.querySelector(".popup__input_job"),h=document.querySelector(".profile__add"),v=(document.querySelector(".cards"),document.querySelector(".popup__input_image")),y=document.querySelector(".popup__input_title"),S=document.querySelector(".popup__form_type_add"),f=document.querySelector(".popup__image"),g=document.querySelector(".popup__subtitle"),E={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",errorClass:"popup__error_visible",inputErrorClass:"popup__input_error"},C=new t(E,i);C.enableValidation(),new t(E,s).enableValidation();const k=new class extends o{constructor(e){super(e)}openPopupZoom=(e,t)=>{this._popupImage=this._popup.querySelector(".popup__image"),this._popupSubtitle=this._popup.querySelector(".popup__subtitle"),this._popupImage.src=e,this._popupImage.alt=t,this._popupSubtitle.textContent=t,super.open()}}(".popup");k.setEventListeners();const L=new class{constructor({items:e,renderer:t},o){this._items=e,this._renderer=t,this._selectorContainer=o}addItem(e){this._selectorContainer.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:t=>{const o=new e(t,k.openPopupZoom,".cards__list").generateCard();L.addItem(o)}},".cards"),q=new class{constructor(e,t){this._name=document.querySelector(e),this._info=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,info:this._info.textContent}}setUserInfo(e){this._name.textContent=e.name,this._info.textContent=e.info}}(".profile__name",".profile__spec");console.log();const b=new class extends o{constructor(e){super(e),this._popupForm=this._popup.querySelector(".popup__form")}_getInputValues(){const e=this._popupForm.querySelectorAll(".popup__input"),t={};return e.forEach((e=>t[e.name]=e.value)),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListner("submit",(e=>{e.preventDefault(),this._submitForm(this._getInputValues()),this._close()}))}close(){this._popup.reset(),super.close()}}("popup__form_type_edit",(e=>{!function(e){q.setUserInfo(e)}(e)}));function x(e,t){I(r),f.src=e,f.alt=t,g.textContent=t}function I(e){e.classList.add("popup_type_opened"),document.addEventListener("mousedown",B),document.addEventListener("keydown",j)}function w(e){e.classList.remove("popup_type_opened"),document.removeEventListener("mousedown",B),document.removeEventListener("keydown",j)}function B(e){const t=document.querySelector(".popup_type_opened");e.target===t&&(w(t),l.reset())}function j(e){const t=document.querySelector(".popup_type_opened");"Escape"===e.key&&w(t)}n.addEventListener("click",(()=>{d.value=q.getUserInfo().name,m.value=q.getUserInfo().info,b.open()})),b.setEventListeners(),p.addEventListener("click",(()=>w(i))),c.addEventListener("click",(()=>w(s))),u.addEventListener("click",(()=>w(r))),n.addEventListener("click",(function(){I(s),d.value=a.textContent,m.value=_.textContent})),l.addEventListener("submit",(function(e){e.preventDefault(),a.textContent=d.value,_.textContent=m.value,l.reset(),w(s)})),h.addEventListener("click",(()=>I(i))),S.addEventListener("submit",(function(t){t.preventDefault();const o={link:v.value,name:y.value};addNewCard(new e(o.link,x,".cards__list").generateCard()),w(i),S.reset(),C.deactivetingSubmit()}))})();